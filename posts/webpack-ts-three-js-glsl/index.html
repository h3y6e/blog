<!DOCTYPE html> <html lang=ja > <head prefix="og: https://ogp.me/ns#"> <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1, maximum-scale=1" /> <meta name=author  content=heyhoe  /> <link type="text/plain" rel=author  href="https://h3y6e.com/humans.txt" /> <link rel=webmention  href="https://webmention.io/h3y6e.com/webmention" /> <link rel=pingback  href="https://webmention.io/h3y6e.com/xmlrpc" /> <link rel=me  href="https://fedibird.com/@h3y6e" /> <link rel=me  href="https://social.camph.net/@h3y6e" /> <meta name=theme-color  content="#2f2f2f" /> <link rel=stylesheet  href="/css/a5ebec.css" /> <link rel=icon  href="/assets/favicon/favicon.ico" /> <link rel=apple-touch-icon  href="/assets/favicon/apple-touch-icon.png" /> <meta property="og:site_name" content="#a5ebec" /> <meta property="og:image" content="https://res.cloudinary.com/dzugrdlkb/image/upload/c_fit,w_840,co_rgb:a5ebec,l_text:Firge35-Bold.ttf_50:webpack%20%2B%20typescript%20%2B%20three.js%E3%81%A7GLSL%20%28.frag%7C.vert%29%20%E3%82%92%E5%A4%96%E9%83%A8%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%81%A8%E3%81%97%E3%81%A6import%E3%81%99%E3%82%8B/fl_layer_apply,g_south_west,x_180,y_355/co_rgb:a5ebec7f,l_text:Firge35-Regular.ttf_30:2019-11-14/fl_layer_apply,g_north_west,x_180,y_565/c_fit,w_840,co_rgb:d3d5d57f,l_text:Firge35-Regular.ttf_30:%23webpack%20%23typescript%20%23threejs%20%23glsl/fl_layer_apply,g_north_west,x_180,y_605/a5ebec-ogimage-left.png" /> <meta name="twitter:card" content=summary_large_image  /> <meta name="twitter:site" content="@h3y6e" /> <meta name="twitter:creator" content="@h3y6e" /> <head prefix="og: https://ogp.me/ns#"> <title> webpack + typescript + three.jsでGLSL (.frag|.vert) を外部モジュールとしてimportする :: #a5ebec </title> <meta name=description  content="typescript + three.jsでGLSLをいい感じに編集したい。" /> <meta property="og:type" content=article  /> <meta property="og:title" content="webpack + typescript + three.jsでGLSL (.frag|.vert) を外部モジュールとしてimportする :: #a5ebec" /> <meta property="og:url" content="https://blog.h3y6e.com/posts/webpack-ts-three-js-glsl/index.html" /> <meta property="og:description" content="typescript + three.jsでGLSLをいい感じに編集したい。" /> <script src="/libs/scripts/noflash.js"></script> <header> <div class=header-inner > <div class=header-logo > <a href="/"><div class=logo >#a5ebec</div></a> </div> <label for=menu-trigger  class=menu >menu</label> </div> <input type=checkbox  id=menu-trigger  /> <nav> <ul> <li><a href="/">Posts</a> <li><a href="/tags">Tags</a> <li><a href="https://twitter.com/h3y6e" rel=me >Twitter</a> <li><a href="https://github.com/h3y6e" rel=me >GitHub</a> <li><a href="/feed.xml">RSS</a> <li class=theme-switcher ><button id=theme-switcher >Theme</button> </ul> </nav> </header> <div class=franklin-headline > <h1 class=title >webpack + typescript + three.jsでGLSL (.frag|.vert) を外部モジュールとしてimportする</h1> <div class=date >2019-11-14</div><span class=tags ><a href="/tags/webpack">#webpack</a> <a href="/tags/typescript">#typescript</a> <a href="/tags/threejs">#threejs</a> <a href="/tags/glsl">#glsl</a> </span></div><div class=franklin-toc ><ol><li><a href="#まとめ">まとめ</a><li><a href="#はじめに">はじめに</a><li><a href="#dts">.d.ts</a><li><a href="#raw-loader">raw-loader</a></ol></div> <div class=franklin-content > <h2 id="まとめ"><a href="#まとめ" class=header-anchor >まとめ</a></h2> <ul> <li><p>型定義ファイルを用意</p> <li><p><code>raw-loader</code> を使用</p> </ul> <h2 id="はじめに"><a href="#はじめに" class=header-anchor >はじめに</a></h2> <p>three.jsで <a href="https://threejs.org/docs/#api/en/materials/ShaderMaterial">ShaderMaterial</a> や <a href="https://threejs.org/docs/#api/en/materials/RawShaderMaterial">RawShaderMaterial</a> を使うと、自作したGLSLを利用することが出来る。 公式ドキュメントで紹介されている方法や、「<a href="https://lmgtfy.com/?q&#61;three.js&#43;glsl&amp;s&#61;g">three.js glsl</a>」とかで検索して出てくる大抵の記事にはhtmlやjsに直書きしている例が見られる。 しかし、これではシンタックスハイライトは効かないし見栄えも良くない。</p> <h2 id=dts ><a href="#dts" class=header-anchor >.d.ts</a></h2> <p>型定義ファイル &#40;<code>.d.ts</code>&#41; を <code>.&#40;frag|vert&#41;</code> ファイルと同じ場所に用意。 </p> <pre><code class=language-julia >:
├── src
│   ├── glsl
│   │   ├── glsl.d.ts
│   │   ├── hoge.frag
│   │   └── hoge.vert
│   └── index.ts
:</code></pre> <p>ファイル名は適当で良いが、自分は <code>glsl.d.ts</code> とした。 内容は以下の通り。</p> <pre><code class=language-ts >declare module &#39;*.vert&#39; &#123;
    const src: string;
    export default src;
&#125;
declare module &#39;*.frag&#39; &#123;
    const src: string;
    export default src;
&#125;</code></pre> <p><code>.&#40;vert|frag&#41;</code> ファイルを外部モジュールとして <code>declare</code> キーワードでアンビエント宣言している。</p> <p><code>.ts</code> ファイルにimportする際のコードは以下のようになる。</p> <pre><code class=language-ts >import hoge_frag from &quot;./glsl/hoge.frag&quot;;
import hoge_vert from &quot;./glsl/hoge.vert&quot;;</code></pre> <h2 id=raw-loader ><a href="#raw-loader" class=header-anchor >raw-loader</a></h2> <p><code>.&#40;ts|js&#41;</code> ではないファイルをimportしたいので、 loaderが必要。</p> <p>npmjs.comで <a href="https://www.npmjs.com/search?q&#61;shader&#37;20loader&#37;20webpack">&quot;shader loader webpack&quot;</a> と検索してみると、パッケージが10個ほど（2019/11/15現在）出てくる。 </p> <p>が、単に <code>.vert</code> と <code>.frag</code> をimportしたいだけであれば、これらを使う必要はない。 テキストをそのまま <code>string</code> として読み込みたいので、 <a href="https://github.com/webpack-contrib/raw-loader">webpack-contrib/raw-loader</a> を用いる。</p> <pre><code class=language-shell >yarn add --dev raw-loader</code></pre>
<p><code>webpack.config.js</code> には以下のように記述する。</p>
<pre><code class=language-js >// &#40;略&#41;
module: &#123;
  rules: &#91;
    &#123;
      test: /.&#40;ts|tsx|js&#41;&#36;/,
      use: &#39;ts-loader&#39;,
      include: &#91;path.resolve&#40;__dirname, &#39;src&#39;&#41;&#93;,
      exclude: /node_modules/
    &#125;,
    &#123;
      test: /.&#40;vert|frag&#41;&#36;/,
      use: &#39;raw-loader&#39;,
      include: &#91;path.resolve&#40;__dirname, &#39;src&#39;&#41;&#93;,
      exclude: /node_modules/
    &#125;
  &#93;
&#125;,
// &#40;略&#41;</code></pre>
<p>完成。   よいシェーダーライフを。</p>
<footer class=page-foot >
  
  <p>
    Comment on <a href="https://twitter.com/intent/tweet?text=Reading%20%40h3y6e%27s%20https%3A%2F%2Fblog.h3y6e.com%2Fposts%2Fwebpack-ts-three-js-glsl%2Findex.html">Twitter</a> /
    <a href="https://elk.zone/intent/post?text=Reading%20%40h3y6e%40fedibird.com%27s%20https%3A%2F%2Fblog.h3y6e.com%2Fposts%2Fwebpack-ts-three-js-glsl%2Findex.html">Mastodon</a>
  </p>
  <p>
    <a href="https://github.com/h3y6e/blog/blob/master/posts/webpack-ts-three-js-glsl.md">
      
      &#xE0A0; Edit this page on GitHub
    </a>
  </p>
  
  <div class=copyright >
    <span>
      &copy; 2019-2024 <a href="https://h3y6e.com">heyhoe</a>
    </span>
    <span>::Powered py <a href="https://franklinjl.org/">Franklin.jl</a></span>
  </div>
</footer>
</div><script src="/libs/scripts/switcher.js"></script>

 <script src="/libs/highlight/highlight.min.js"></script>
<script src="/libs/highlight/ln.min.js"></script>
<script>
  hljs.initHighlightingOnLoad();
  hljs.initLineNumbersOnLoad({ singleLine: true });
  hljs.configure({ tabReplace: "    " });
</script>